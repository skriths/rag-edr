CVE-2024-0007: PostgreSQL SQL Injection via Extension Functions

Severity: CRITICAL (CVSS 9.1)
Affected Versions: PostgreSQL 12.0 - 15.5
Published: 2024-02-12

Description:
A SQL injection vulnerability exists in PostgreSQL extension functions that process user-supplied input. This allows authenticated users to execute arbitrary SQL commands and potentially gain superuser privileges.

Impact:
- Complete database compromise
- Unauthorized data access and modification
- Privilege escalation to database superuser
- Potential for lateral movement to host system

Remediation Steps:
1. Upgrade to PostgreSQL 15.6 or 14.11 or 13.14 or 12.18 immediately
2. Review and update all custom extension functions
3. Audit user permissions and revoke unnecessary EXECUTE privileges
4. Enable statement logging for security monitoring:
   log_statement = 'all'
   log_line_prefix = '%t [%p]: [%l-1] user=%u,db=%d,app=%a,client=%h '
5. Implement input validation in application layer
6. Use prepared statements and parameterized queries
7. Regular security audits of database roles and permissions

Post-Patch Actions:
1. Restart PostgreSQL service
2. Verify version: SELECT version();
3. Review pg_log for suspicious activity
4. Update connection security (pg_hba.conf)

Source: debian.org/security
